FROM node:22-alpine

# Install system dependencies
RUN apk add --no-cache git python3 make g++ cmake linux-headers openssl curl bash

# Install OpenClaw globally
RUN npm install -g openclaw@latest

# Install uv for Alhazen skill scripts
USER 1000:1000
RUN curl -LsSf https://astral.sh/uv/install.sh | sh
ENV PATH="/home/node/.local/bin:$PATH"

WORKDIR /home/node

# Default command (force bind to 0.0.0.0 for container networking)
CMD ["openclaw", "gateway", "--allow-unconfigured", "--bind", "lan"]
